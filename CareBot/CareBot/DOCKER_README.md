# CareBot Docker Setup

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–¥–µ–ª–∞–ª–∏)
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞**:
   ```bash
   cd CareBot
   ```
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —É–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–∫—Ä–∏–ø—Ç**:
   ```bash
   manage.bat
   ```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs webapp

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–∏—Å—ã

- **WebApp** (–ø–æ—Ä—Ç 8080): –û—Å–Ω–æ–≤–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ Mini App
- **Database** (–ø–æ—Ä—Ç 5432): PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Redis** (–ø–æ—Ä—Ç 6379): –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–µ—Å—Å–∏–∏
- **Nginx** (–ø–æ—Ä—Ç 80/443): Reverse proxy –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- **Telegram Bot**: Telegram –±–æ—Ç (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- **Mobile Sync**: API –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### –î–æ—Å—Ç—É–ø–Ω—ã–µ URL

- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: http://localhost:8080/
- **Mini App**: http://localhost:8080/miniapp
- **API Health**: http://localhost:8080/health
- **API Missions**: http://localhost:8080/api/missions
- **Nginx (–ø—Ä–æ–∫—Å–∏)**: http://localhost/

## API Endpoints

### Health Check
```
GET /health
```

### Missions API
```
GET /api/missions          # –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –º–∏—Å—Å–∏–∏
POST /api/missions         # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏—Å—Å–∏—é
POST /api/missions/{id}/complete  # –ó–∞–≤–µ—Ä—à–∏—Ç—å –º–∏—Å—Å–∏—é
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:8080/health

# –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏—Å—Å–∏–π
curl http://localhost:8080/api/missions

# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏—Å—Å–∏–∏
curl -X POST http://localhost:8080/api/missions \
  -H "Content-Type: application/json" \
  -d '{"name": "–ù–æ–≤–∞—è –º–∏—Å—Å–∏—è", "difficulty": "easy", "reward": 150}'
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –£–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–∫—Ä–∏–ø—Ç (manage.bat)
–ó–∞–ø—É—Å—Ç–∏—Ç–µ `manage.bat` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –∏ –ª–æ–≥–æ–≤
- –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤

### Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
docker-compose build webapp

# –¢–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (–±–µ–∑ telegram bot)
docker-compose up -d database redis webapp nginx

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f webapp

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart webapp

# –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
docker-compose down -v
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
CareBot/
‚îú‚îÄ‚îÄ docker-compose.yml      # –ì–ª–∞–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile             # WebApp –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îú‚îÄ‚îÄ Dockerfile.bot         # Telegram Bot –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä  
‚îú‚îÄ‚îÄ nginx.conf             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ server_app.py          # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ manage.bat             # –£–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
‚îî‚îÄ‚îÄ database/              # SQL —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

1. –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –≤ `server_app.py`
2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker-compose build webapp`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: `docker-compose restart webapp`

### –û—Ç–ª–∞–¥–∫–∞

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
docker-compose exec webapp bash

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker-compose exec webapp env

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose exec webapp ls -la /app
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs service_name`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑: `docker-compose build`

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
1. –î–æ–∂–¥–∏—Ç–µ—Å—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î: `docker-compose logs database`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ docker-compose.yml

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check: `curl http://localhost:8080/health`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs webapp nginx`

## –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker 20.10+
- Docker Compose 2.0+
- 2GB RAM –º–∏–Ω–∏–º—É–º
- 10GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
1. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ `.env` —Ñ–∞–π–ª–µ
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è Nginx
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º –ë–î –∏ Redis
4. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- Health checks –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `docker-compose logs`
- –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Prometheus

---
**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞**: –ê–≤–≥—É—Å—Ç 2025

## üéâ –°—Ç–∞—Ç—É—Å: –†–ê–ë–û–¢–ê–ï–¢!

**‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç:**
- Database (PostgreSQL) - –ø–æ—Ä—Ç 5432
- Redis Cache - –ø–æ—Ä—Ç 6379  
- WebApp (Flask + Mini App) - **–ø–æ—Ä—Ç 8080** ‚Üê –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!
- Nginx Proxy - –ø–æ—Ä—Ç 80

**üåê –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ URL:**
- Mini App: http://localhost:8080/miniapp ‚úÖ
- API: http://localhost:8080/api/missions ‚úÖ
- Health: http://localhost:8080/health ‚úÖ
