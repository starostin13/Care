# üéØ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∏—Å—Å–∏–π —á–µ—Ä–µ–∑ Telegram Bot

## üìñ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–≥—Ä–æ–∫–∞–º –≤–≤–æ–¥–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏—Å—Å–∏–π —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ—Å—Ç—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã. –ú–∏—Å—Å–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ —Å—Ç–∞–Ω—Ü–∏—é –ø–µ—á–∞—Ç–∏, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–≤–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:
1. **Mission Engine** (`mission_engine/__init__.py`) - —è–¥—Ä–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏—Å—Å–∏—è–º–∏
2. **Mobile App** (`mobile_app/crusade_mobile.py`) - –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∏—Å—Å–∏–π
3. **Telegram Bot** (`handlers.py`) - –±–æ—Ç –¥–ª—è –≤–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. **Print Station** - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–µ—á–∞—Ç–∏ –º–∏—Å—Å–∏–π

### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
```
Mobile App ‚Üí Generate Mission ‚Üí Print ‚Üí Play ‚Üí Telegram Result ‚Üí Map Update
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –º–∏—Å—Å–∏–∏ (–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
```python
python mobile_app/crusade_mobile.py
```
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∏—Å—Å–∏—é —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, M123)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ WiFi

### 2. –ü–µ—á–∞—Ç—å –º–∏—Å—Å–∏–∏
–ú–∏—Å—Å–∏—è –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è —Å —Ñ–æ—Ä–º–∞—Ç–æ–º:
```
üéØ –ú–ò–°–°–ò–Ø: Infiltration
üÜî ID: M123
==================================================
üìç –õ–æ–∫–∞—Ü–∏—è: Hex 15
üéÆ –¢–∏–ø: killteam
...
üí° –î–ª—è –≤–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ Telegram:
   /result M123 [–≤–∞—à–∏_–æ—á–∫–∏] [–æ—á–∫–∏_–ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞]
```

### 3. –í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (Telegram)

#### –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞:
```
/result M123 15 8
```
–ì–¥–µ:
- `M123` - ID –º–∏—Å—Å–∏–∏ (—Å —Ä–∞—Å–ø–µ—á–∞—Ç–∫–∏)
- `15` - –≤–∞—à–∏ –æ—á–∫–∏
- `8` - –æ—á–∫–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```
/missions_list        - —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∏—Å—Å–∏–π
/help_missions       - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
```

#### –ü—Ä–∏–º–µ—Ä—ã:
```
/result M456 20 12   # –ü–æ–±–µ–¥–∞ 20:12
/result M789 10 10   # –ù–∏—á—å—è 10:10
/result M001 5 15    # –ü–æ—Ä–∞–∂–µ–Ω–∏–µ 5:15
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install python-telegram-bot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞:
1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `config.py`:
```python
crusade_care_bot_telegram_token = "YOUR_BOT_TOKEN"
```

### 3. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:
```bash
python handlers.py
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
python test_mission_results.py
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Mission Engine –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- **–¢–∏–ø—ã –º–∏—Å—Å–∏–π**: Kill Team, WH40K, Boarding Action, Combat Patrol, Battlefleet
- **–§—Ä–∞–∫—Ü–∏–∏**: Space Marines, Chaos, Orks, Eldar, Tyranids, Imperial Guard, Necrons, Tau
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: JSON —Ñ–∞–π–ª—ã —Å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

### Telegram Bot –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- **–ö–æ–º–∞–Ω–¥—ã**: `/result`, `/missions_list`, `/help_missions`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –§–æ—Ä–º–∞—Ç ID, —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –º–∏—Å—Å–∏–π
- **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üìã API –º–µ—Ç–æ–¥–æ–≤

### MissionStorage
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–∏—Å—Å–∏–∏
mission = generator.generate_mission(mission_type, participants, target_hex)
storage.save_mission(mission)

# –ü–æ–∏—Å–∫ –º–∏—Å—Å–∏–∏
mission = storage.get_mission_by_short_id("M123")

# –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∏—Å—Å–∏–∏
success = storage.complete_mission_by_short_id("M123", "15 - 8", "player1")

# –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∏—Å—Å–∏–π
active_missions = storage.get_active_missions()
```

### Telegram –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
async def result_command(update, context):
    # –ü–∞—Ä—Å–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
    # –ü–æ–∏—Å–∫ –º–∏—Å—Å–∏–∏
    # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
async def confirm_result_callback(update, context):
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
    # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞:

1. **–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID**: `‚ùå ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–∞ M123, M456 –∏ —Ç.–¥.`
2. **–ú–∏—Å—Å–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞**: `‚ùå –ú–∏—Å—Å–∏—è M123 –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!`
3. **–ú–∏—Å—Å–∏—è —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞**: `‚ö†Ô∏è –ú–∏—Å—Å–∏—è M123 —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!`
4. **–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—á–∫–æ–≤**: `‚ùå –û—á–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Å–ª–∞–º–∏!`
5. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤**: `‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥—ã!`

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–¢–æ–ª—å–∫–æ Telegram**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
python test_mission_results.py
```

### –¢–µ—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –º–∏—Å—Å–∏–π —Å –∫–æ—Ä–æ—Ç–∫–∏–º–∏ ID
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É ID
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∏—Å—Å–∏–π
- ‚úÖ –°–∏–º—É–ª—è—Ü–∏—è Telegram –∫–æ–º–∞–Ω–¥
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üì± –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`mobile_app/crusade_mobile.py`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∏—Å—Å–∏–∏ —Å –∫–æ—Ä–æ—Ç–∫–∏–º–∏ ID
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
4. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—á–∞—Ç—å —Å QR-–∫–æ–¥–∞–º–∏

## üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∏—Å—Å–∏–π
- –ü–µ—á–∞—Ç—å –º–∏—Å—Å–∏–π
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å –º–æ–±–∏–ª—å–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º

## üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É:
- –ú–æ–±–∏–ª—å–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- –°–µ—Ä–≤–µ—Ä–æ–º
- Telegram –±–æ—Ç–æ–º
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:
- –°–æ–∑–¥–∞–Ω–∏–µ –º–∏—Å—Å–∏–π
- –í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã

## üöÄ –†–∞–∑–≤–∏—Ç–∏–µ

–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –º–∏—Å—Å–∏—è—Ö
- –ì—Ä—É–ø–ø–æ–≤—ã–µ –º–∏—Å—Å–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–≥—Ä
